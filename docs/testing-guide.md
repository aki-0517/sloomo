# 動作確認・テストガイド

このドキュメントでは、Solana Mobile CreditPayアプリの包括的なテスト手順を説明します。

## 🎯 テスト概要

### テスト目的
- ハッカソン提出前の品質保証
- Solana Mobile Stack機能の動作確認
- 信用決済システムの正確性検証
- ユーザビリティの評価

### テスト環境
- **プライマリ**: Android 12+ 実機（Saga phone推奨）
- **セカンダリ**: Android Virtual Device (API 31+)
- **ネットワーク**: Solana Devnet
- **データベース**: Supabase (開発環境)

## 📱 1. 基本機能テスト

### 1.1 アプリ起動テスト

#### テスト手順
1. **アプリアイコン**をタップしてアプリを起動
2. **スプラッシュスクリーン**が3秒以内に表示されることを確認
3. **ホーム画面**が正常に読み込まれることを確認
4. **ナビゲーション**が正常に動作することを確認

#### 期待される結果
- [ ] アプリが3秒以内に起動する
- [ ] クラッシュやエラーが発生しない
- [ ] UI要素が正しく表示される
- [ ] ナビゲーションがスムーズに動作する

#### エラー対処
```bash
# アプリが起動しない場合
adb logcat | grep "ReactNativeJS"

# キャッシュクリア
npx react-native start --reset-cache
```

### 1.2 ウォレット接続テスト

#### 事前準備
- Phantom WalletまたはSolflare Walletをインストール
- Devnetに設定
- テスト用SOLを取得

#### テスト手順
1. **Connect Wallet**ボタンをタップ
2. **Mobile Wallet Adapter**選択画面で任意のウォレットを選択
3. **認証画面**でアプリ連携を承認
4. **ウォレットアドレス**が正しく表示されることを確認

#### 期待される結果
- [ ] MWAが正常に起動する
- [ ] ウォレット選択が表示される
- [ ] 認証が成功する
- [ ] ウォレットアドレスが表示される
- [ ] 接続ステータスが「Connected」になる

#### トラブルシューティング
```bash
# MWA接続エラーの場合
# 1. ウォレットアプリを最新版に更新
# 2. デバイスの再起動
# 3. アプリの再インストール

# ログ確認
adb logcat | grep "MobileWalletAdapter"
```

## 💰 2. 残高・決済機能テスト

### 2.1 残高表示テスト

#### テスト手順
1. ウォレット接続完了後、**Balance**セクションを確認
2. **SOL残高**が正しく表示されることを確認
3. **USDC残高**が正しく表示されることを確認
4. **更新ボタン**で残高が最新化されることを確認

#### 期待される結果
- [ ] SOL残高が正確に表示される
- [ ] USDC残高が正確に表示される
- [ ] 残高の更新が正常に動作する
- [ ] 表示形式が適切（小数点以下の桁数等）

### 2.2 QRコード決済テスト

#### QRコード生成テスト
1. **Payment**画面で**Generate QR**をタップ
2. **金額**を入力（例: 5 USDC）
3. **メモ**を入力（オプション）
4. **Generate**ボタンをタップ
5. QRコードが正常に生成されることを確認

#### QRコードスキャンテスト
1. **Scan QR**ボタンをタップ
2. **カメラ権限**を許可
3. 生成したQRコードをスキャン
4. **決済情報**が正しく解析されることを確認
5. **Confirm Payment**で決済を実行

#### 期待される結果
- [ ] QRコードが正常に生成される
- [ ] QRコードに正しい情報が含まれる
- [ ] カメラでQRコードを読み取れる
- [ ] 決済情報が正確に解析される
- [ ] 決済が正常に処理される

### 2.3 P2P送金テスト

#### テスト手順
1. **Transfer**画面を開く
2. **受信者アドレス**を入力
3. **送金額**を入力（例: 1 USDC）
4. **Send**ボタンをタップ
5. **確認画面**で内容を確認
6. **Confirm**で送金を実行

#### 期待される結果
- [ ] アドレス入力が正常に動作する
- [ ] 送金額の検証が正常に動作する
- [ ] 確認画面で正しい情報が表示される
- [ ] 送金が正常に処理される
- [ ] 取引履歴に記録される

## 📊 3. 信用スコア機能テスト

### 3.1 信用スコア計算テスト

#### テスト手順
1. **Credit Score**画面を開く
2. **Calculate Score**ボタンをタップ
3. **オンチェーン分析**が開始されることを確認
4. **スコア結果**が表示されることを確認
5. **詳細内訳**が表示されることを確認

#### 期待される結果
- [ ] スコア計算が30秒以内に完了する
- [ ] スコアが300-850の範囲で表示される
- [ ] オンチェーン/オフチェーン/ZK証明の内訳が表示される
- [ ] 計算履歴がSupabaseに保存される

#### テストデータ
```javascript
// テスト用ウォレットアドレス（取引履歴あり）
const testWallets = [
  "9WzDXwBbmkg8ZTbNMqUxvQRAyrZzDsGYdLVL9zYtAWWM", // 高スコア想定
  "2xNweLHLqrbx4zo1waDvgWJHgsUpPj8Y8icbAFeR4a8T", // 中スコア想定
  "5oNDL3swdJJF1g9DzJiZ4ynHXgszjAEpXzvb37gSPvxy"  // 低スコア想定
];
```

### 3.2 クレジットライン機能テスト

#### テスト手順
1. 信用スコア600以上のウォレットでテスト
2. **Request Credit Line**ボタンをタップ
3. **希望額**を入力（例: 500 USDC）
4. **Apply**ボタンをタップ
5. **承認結果**が表示されることを確認

#### 期待される結果
- [ ] 信用スコアに基づいて承認/否認が決定される
- [ ] 承認額とAPRが適切に設定される
- [ ] クレジットライン情報がUIに表示される
- [ ] データベースに正しく記録される

## 🔄 4. データ同期・リアルタイム機能テスト

### 4.1 Supabaseリアルタイム同期テスト

#### テスト手順
1. **2台のデバイス**で同じユーザーアカウントにログイン
2. **デバイス1**で取引を実行
3. **デバイス2**で取引履歴が自動更新されることを確認
4. **残高**がリアルタイムで同期されることを確認

#### 期待される結果
- [ ] 取引履歴がリアルタイムで同期される
- [ ] 残高が自動的に更新される
- [ ] 同期遅延が5秒以内
- [ ] データの整合性が保たれる

### 4.2 オフライン・オンライン切り替えテスト

#### テスト手順
1. **オンライン状態**でアプリを使用
2. **機内モード**に切り替え
3. **キャッシュされたデータ**が表示されることを確認
4. **オンライン復帰**後にデータが同期されることを確認

#### 期待される結果
- [ ] オフライン時にキャッシュデータが表示される
- [ ] オンライン復帰時に自動同期される
- [ ] データ損失が発生しない
- [ ] 適切なエラーメッセージが表示される

## 🚨 6. エラー処理・セキュリティテスト

### 6.1 エラーハンドリングテスト

#### ネットワークエラーテスト
1. **インターネット接続**を一時的に切断
2. **API呼び出し**を実行
3. **適切なエラーメッセージ**が表示されることを確認
4. **接続復旧**後の動作を確認

#### 不正入力テスト
```javascript
// テストケース
const invalidInputs = [
  "", // 空文字
  "invalid_wallet_address", // 不正なウォレットアドレス
  "-100", // 負の数値
  "99999999999", // 上限超過
  "abc", // 文字列（数値欄）
  "<script>alert('xss')</script>" // XSS攻撃
];
```

#### 期待される結果
- [ ] 不正入力が適切にバリデーションされる
- [ ] ユーザーフレンドリーなエラーメッセージが表示される
- [ ] アプリがクラッシュしない
- [ ] セキュリティ脆弱性が存在しない

### 6.2 セキュリティテスト

#### 秘密鍵保護テスト
1. **アプリデータ**をエクスポート
2. **秘密鍵**が平文で保存されていないことを確認
3. **Mobile Wallet Adapter**経由の署名動作を確認

#### Row Level Security テスト
1. **他ユーザーのデータ**にアクセスを試行
2. **403 Forbidden**エラーが返されることを確認
3. **SQL Injection**攻撃への耐性を確認

## 📈 7. パフォーマンステスト

### 7.1 レスポンス時間測定

#### 測定項目
- **アプリ起動時間**: 目標3秒以内
- **ウォレット接続時間**: 目標10秒以内
- **残高取得時間**: 目標5秒以内
- **信用スコア計算時間**: 目標30秒以内
- **決済処理時間**: 目標15秒以内

#### 測定方法
```javascript
// パフォーマンス測定用コード
console.time('wallet_connection');
await connectWallet();
console.timeEnd('wallet_connection');
```

### 7.2 メモリ・CPU使用量測定

#### Android Studio Profilerを使用
1. **CPU Profiler**でCPU使用率を監視
2. **Memory Profiler**でメモリリークを確認
3. **Network Profiler**でAPI呼び出しを分析

#### 期待される結果
- [ ] CPU使用率が30%以下
- [ ] メモリ使用量が500MB以下
- [ ] メモリリークが発生しない
- [ ] バッテリー消費が許容範囲内

## 🎯 8. ユーザビリティテスト

### 8.1 UI/UXテスト

#### テスト項目
- **画面遷移**のスムーズさ
- **ボタンの応答性**
- **文字の可読性**
- **色彩のアクセシビリティ**
- **タッチターゲットのサイズ**

#### アクセシビリティテスト
1. **TalkBack**（スクリーンリーダー）での操作テスト
2. **大きな文字サイズ**での表示テスト
3. **ダークモード**での表示テスト

### 8.2 実ユーザーテスト

#### テストシナリオ
1. **初回ユーザー**: アプリのダウンロードから初回決済まで
2. **既存ユーザー**: 日常的な決済・送金操作
3. **クレジット利用**: 信用スコア確認からクレジット利用まで

#### 評価指標
- **タスク完了率**: 目標90%以上
- **平均完了時間**: 各タスク3分以内
- **ユーザー満足度**: 5段階評価で4以上
- **エラー発生率**: 目標5%以下

## 📋 9. テスト結果レポート

### 9.1 テスト実行チェックリスト

#### 基本機能
- [ ] アプリ起動テスト
- [ ] ウォレット接続テスト
- [ ] 残高表示テスト
- [ ] QR決済テスト
- [ ] P2P送金テスト

#### 信用機能
- [ ] 信用スコア計算テスト
- [ ] クレジットライン申請テスト
- [ ] 信用決済テスト

#### データ同期
- [ ] Supabaseリアルタイム同期テスト
- [ ] オフライン対応テスト

#### セキュリティ
- [ ] エラーハンドリングテスト
- [ ] セキュリティテスト
- [ ] バリデーションテスト

#### パフォーマンス
- [ ] レスポンス時間測定
- [ ] リソース使用量測定
- [ ] ストレステスト

#### BONK統合
- [ ] BONK残高表示テスト
- [ ] BONK決済テスト
- [ ] BONK特殊機能テスト

### 9.2 問題報告テンプレート

```markdown
## バグレポート

### 問題の概要
[簡潔な問題の説明]

### 再現手順
1. [手順1]
2. [手順2]
3. [手順3]

### 期待される結果
[期待していた動作]

### 実際の結果
[実際に発生した動作]

### 環境情報
- デバイス: [例: Pixel 7]
- Android版: [例: Android 13]
- アプリ版: [例: v1.0.0]
- ウォレット: [例: Phantom v1.2.3]

### ログ・スクリーンショット
[関連するログやスクリーンショット]

### 重要度
- [ ] Critical (アプリがクラッシュ)
- [ ] High (主要機能が動作しない)
- [ ] Medium (一部機能に問題)
- [ ] Low (UI/UXの改善点)
```

## 🎉 10. ハッカソン提出前の最終確認

### 10.1 必須機能チェック

#### Solana Mobile Stack統合
- [ ] Mobile Wallet Adapter統合
- [ ] Solana Pay機能
- [ ] トークン残高表示
- [ ] 取引署名・確認

#### 独自機能
- [ ] 信用スコアリング
- [ ] 自動クレジットライン
- [ ] QR決済システム
- [ ] リアルタイムデータ同期

#### BONK統合（ボーナス賞金用）
- [ ] BONK残高・決済
- [ ] BONK特殊機能
- [ ] BONK統合のデモ動画

### 10.2 提出物準備

#### 必要ファイル
- [ ] **APKファイル**: 動作確認済みの最新版
- [ ] **ソースコード**: GitHubリポジトリ
- [ ] **デモ動画**: 3-5分の機能紹介動画
- [ ] **ピッチ資料**: プレゼンテーション用スライド

#### ドキュメント
- [ ] **README.md**: インストール・セットアップ手順
- [ ] **技術仕様書**: アーキテクチャとAPI仕様
- [ ] **テストレポート**: 動作確認結果
- [ ] **ユーザーガイド**: 使用方法の説明

おめでとうございます！すべてのテストが完了すれば、ハッカソンへの提出準備が整います。🏆